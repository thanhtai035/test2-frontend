{"ast":null,"code":"/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { get } from '../http/request.js';\nimport { clone, omit, find } from '../util/object.js';\nimport { isObject } from '../util/types.js';\nimport { toQueryString } from '../util/url.js';\nimport AuthSdkError from '../errors/AuthSdkError.js';\nimport { addStateToken } from './util.js';\nimport { getPollFn } from './poll.js';\nimport { postToTransaction } from './api.js';\n\nclass AuthTransaction {\n  constructor(sdk) {\n    let res = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    this.data = undefined;\n    this.status = undefined;\n\n    if (res) {\n      this.data = res;\n\n      if (this.data.interactionHandle) {\n        this.status = res.status;\n        return;\n      }\n\n      Object.assign(this, flattenEmbedded(sdk, res, res, {}));\n      delete this.stateToken;\n\n      if (res.status === 'RECOVERY_CHALLENGE' && !res._links) {\n        this.cancel = function () {\n          return Promise.resolve(sdk.tx.createTransaction());\n        };\n      }\n    }\n  }\n\n}\n\nfunction link2fn(sdk, res, obj, link, ref) {\n  if (Array.isArray(link)) {\n    return function (name, opts) {\n      if (!name) {\n        throw new AuthSdkError('Must provide a link name');\n      }\n\n      var lk = find(link, {\n        name: name\n      });\n\n      if (!lk) {\n        throw new AuthSdkError('No link found for that name');\n      }\n\n      return link2fn(sdk, res, obj, lk, ref)(opts);\n    };\n  } else if (link.hints && link.hints.allow && link.hints.allow.length === 1) {\n    var method = link.hints.allow[0];\n\n    switch (method) {\n      case 'GET':\n        return function () {\n          return get(sdk, link.href, {\n            withCredentials: true\n          });\n        };\n\n      case 'POST':\n        return function (opts) {\n          if (ref && ref.isPolling) {\n            ref.isPolling = false;\n          }\n\n          var data = addStateToken(res, opts);\n\n          if (res.status === 'MFA_ENROLL' || res.status === 'FACTOR_ENROLL') {\n            Object.assign(data, {\n              factorType: obj.factorType,\n              provider: obj.provider\n            });\n          }\n\n          var params = {};\n          var autoPush = data.autoPush;\n\n          if (autoPush !== undefined) {\n            if (typeof autoPush === 'function') {\n              try {\n                params.autoPush = !!autoPush();\n              } catch (e) {\n                return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n              }\n            } else if (autoPush !== null) {\n              params.autoPush = !!autoPush;\n            }\n\n            data = omit(data, 'autoPush');\n          }\n\n          var rememberDevice = data.rememberDevice;\n\n          if (rememberDevice !== undefined) {\n            if (typeof rememberDevice === 'function') {\n              try {\n                params.rememberDevice = !!rememberDevice();\n              } catch (e) {\n                return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n              }\n            } else if (rememberDevice !== null) {\n              params.rememberDevice = !!rememberDevice;\n            }\n\n            data = omit(data, 'rememberDevice');\n          } else if (data.profile && data.profile.updatePhone !== undefined) {\n            if (data.profile.updatePhone) {\n              params.updatePhone = true;\n            }\n\n            data.profile = omit(data.profile, 'updatePhone');\n          }\n\n          var href = link.href + toQueryString(params);\n          return postToTransaction(sdk, href, data);\n        };\n    }\n  }\n}\n\nfunction links2fns(sdk, res, obj, ref) {\n  var fns = {};\n\n  for (var linkName in obj._links) {\n    if (!Object.prototype.hasOwnProperty.call(obj._links, linkName)) {\n      continue;\n    }\n\n    var link = obj._links[linkName];\n\n    if (linkName === 'next') {\n      linkName = link.name;\n    }\n\n    if (link.type) {\n      fns[linkName] = link;\n      continue;\n    }\n\n    switch (linkName) {\n      case 'poll':\n        fns.poll = getPollFn(sdk, res, ref);\n        break;\n\n      default:\n        var fn = link2fn(sdk, res, obj, link, ref);\n\n        if (fn) {\n          fns[linkName] = fn;\n        }\n\n    }\n  }\n\n  return fns;\n}\n\nfunction flattenEmbedded(sdk, res, obj, ref) {\n  obj = obj || res;\n  obj = clone(obj);\n\n  if (Array.isArray(obj)) {\n    var objArr = [];\n\n    for (var o = 0, ol = obj.length; o < ol; o++) {\n      objArr.push(flattenEmbedded(sdk, res, obj[o], ref));\n    }\n\n    return objArr;\n  }\n\n  var embedded = obj._embedded || {};\n\n  for (var key in embedded) {\n    if (!Object.prototype.hasOwnProperty.call(embedded, key)) {\n      continue;\n    }\n\n    if (isObject(embedded[key]) || Array.isArray(embedded[key])) {\n      embedded[key] = flattenEmbedded(sdk, res, embedded[key], ref);\n    }\n  }\n\n  var fns = links2fns(sdk, res, obj, ref);\n  Object.assign(embedded, fns);\n  obj = omit(obj, '_embedded', '_links');\n  Object.assign(obj, embedded);\n  return obj;\n}\n\nexport { AuthTransaction };","map":{"version":3,"mappings":"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","names":["AuthTransaction","constructor","res","data","undefined","status","interactionHandle","Object","assign","flattenEmbedded","sdk","stateToken","_links","cancel","Promise","resolve","tx","createTransaction","link2fn","obj","link","ref","Array","isArray","name","opts","AuthSdkError","lk","find","hints","allow","length","method","get","href","withCredentials","isPolling","addStateToken","factorType","provider","params","autoPush","e","reject","omit","rememberDevice","profile","updatePhone","toQueryString","postToTransaction","links2fns","fns","linkName","prototype","hasOwnProperty","call","type","poll","getPollFn","fn","clone","objArr","o","ol","push","embedded","_embedded","key","isObject"],"sources":["C:\\Users\\ADMIN\\Downloads\\okta-springboot-react-master\\okta-springboot-react-master\\test2-s3760615\\node_modules\\@okta\\lib\\tx\\AuthTransaction.ts"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n\nimport { get } from '../http';\nimport { find, omit, toQueryString, clone, isObject } from '../util';\nimport AuthSdkError from '../errors/AuthSdkError';\nimport { TransactionState } from './TransactionState';\nimport { addStateToken } from './util';\nimport { getPollFn } from './poll';\nimport { postToTransaction } from './api';\nimport { IdxStatus } from '../idx/types';\n\ninterface PostToTransactionParams {\n  autoPush?: boolean;\n  rememberDevice?: boolean;\n  updatePhone?: boolean;\n}\n\n// eslint-disable-next-line no-use-before-define\ntype AuthTransactionFunction = (obj?: any) => Promise<AuthTransaction>;\n\ninterface AuthTransactionFunctions {\n  // common\n  next?: AuthTransactionFunction;\n  cancel?: AuthTransactionFunction;\n  skip?: AuthTransactionFunction;\n  // locked_out\n  unlock?: AuthTransactionFunction;\n  // password\n  changePassword?: AuthTransactionFunction;\n  resetPassword?: AuthTransactionFunction;\n  // recovery\n  answer?: AuthTransactionFunction;\n  recovery?: AuthTransactionFunction;\n  // recovery_challenge\n  verify?: AuthTransactionFunction;\n  resend?: AuthTransactionFunction;\n  // mfa_enroll_activate\n  activate?: AuthTransactionFunction;\n  poll?: AuthTransactionFunction;\n  prev?: AuthTransactionFunction;\n}\n\nexport class AuthTransaction implements TransactionState, AuthTransactionFunctions {\n  next?: AuthTransactionFunction;\n  cancel?: AuthTransactionFunction;\n  skip?: AuthTransactionFunction;\n  unlock?: AuthTransactionFunction;\n  changePassword?: AuthTransactionFunction;\n  resetPassword?: AuthTransactionFunction;\n  answer?: AuthTransactionFunction;\n  recovery?: AuthTransactionFunction;\n  verify?: AuthTransactionFunction;\n  resend?: AuthTransactionFunction;\n  activate?: AuthTransactionFunction;\n  poll?: AuthTransactionFunction;\n  prev?: AuthTransactionFunction;\n\n  data?: TransactionState;\n  stateToken?: string;\n  sessionToken?: string;\n  status: string | IdxStatus;\n  user?: Record<string, any>;\n  factor?: Record<string, any>;\n  factors?: Array<Record<string, any> >;\n  policy?: Record<string, any>;\n  scopes?: Array<Record<string, any> >;\n  target?: Record<string, any>;\n  authentication?: Record<string, any>;\n  constructor(sdk, res: TransactionState | null = null) {\n    this.data = undefined;\n    this.status = undefined as unknown as string;\n    if (res) {\n      this.data = res;\n\n      if (this.data.interactionHandle) {\n        this.status = res.status;\n        return;\n      }\n\n      // Parse response from Authn V1\n      Object.assign(this, flattenEmbedded(sdk, res, res, {}));\n      delete this.stateToken;\n\n      // RECOVERY_CHALLENGE has some responses without _links.\n      // Without _links, we emulate cancel to make it intuitive\n      // to return to the starting state. We may remove this\n      // when OKTA-75434 is resolved\n      if (res.status === 'RECOVERY_CHALLENGE' && !res._links) {\n        this.cancel = function() {\n          return Promise.resolve(sdk.tx.createTransaction());\n        };\n      }\n    }\n  }\n}\n\nfunction link2fn(sdk, res, obj, link, ref) {\n  if (Array.isArray(link)) {\n    return function(name, opts?) {\n      if (!name) {\n        throw new AuthSdkError('Must provide a link name');\n      }\n\n      var lk = find(link, {name: name});\n      if (!lk) {\n        throw new AuthSdkError('No link found for that name');\n      }\n\n      return link2fn(sdk, res, obj, lk, ref)(opts);\n    };\n\n  } else if (link.hints &&\n      link.hints.allow &&\n      link.hints.allow.length === 1) {\n    var method = link.hints.allow[0];\n    switch (method) {\n\n      case 'GET':\n        return function() {\n          return get(sdk, link.href, { withCredentials: true });\n        };\n\n      case 'POST':\n        // eslint-disable-next-line max-statements,complexity\n        return function(opts: TransactionState) {\n          if (ref && ref.isPolling) {\n            ref.isPolling = false;\n          }\n\n          var data = addStateToken(res, opts);\n\n          if (res.status === 'MFA_ENROLL' || res.status === 'FACTOR_ENROLL') {\n            // Add factorType and provider\n            Object.assign(data, {\n              factorType: obj.factorType,\n              provider: obj.provider\n            });\n          }\n\n          var params = {} as PostToTransactionParams;\n          var autoPush = data.autoPush;\n          if (autoPush !== undefined) {\n            if (typeof autoPush === 'function') {\n              try {\n                params.autoPush = !!autoPush();\n              }\n              catch (e) {\n                return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n              }\n            }\n            else if (autoPush !== null) {\n              params.autoPush = !!autoPush;\n            }\n            data = omit(data, 'autoPush');\n          }\n\n          var rememberDevice = data.rememberDevice;\n          if (rememberDevice !== undefined) {\n            if (typeof rememberDevice === 'function') {\n              try {\n                params.rememberDevice = !!rememberDevice();\n              }\n              catch (e) {\n                return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n              }\n            }\n            else if (rememberDevice !== null) {\n              params.rememberDevice = !!rememberDevice;\n            }\n            data = omit(data, 'rememberDevice');\n\n          } else if (data.profile &&\n                    data.profile.updatePhone !== undefined) {\n            if (data.profile.updatePhone) {\n              params.updatePhone = true;\n            }\n            data.profile = omit(data.profile, 'updatePhone');\n          }\n          var href = link.href + toQueryString(params);\n          return postToTransaction(sdk, href, data);\n        };\n    }\n  }\n}\n\nfunction links2fns(sdk, res, obj, ref) {\n  var fns = {} as AuthTransactionFunctions;\n  for (var linkName in obj._links) {\n    if (!Object.prototype.hasOwnProperty.call(obj._links, linkName)) {\n      continue;\n    }\n\n    var link = obj._links[linkName];\n    \n    if (linkName === 'next') {\n      linkName = link.name;\n    }\n\n    if (link.type) {\n      fns[linkName] = link;\n      continue;\n    }\n\n    switch (linkName) {\n      // poll is only found at the transaction\n      // level, so we don't need to pass the link\n      case 'poll':\n        fns.poll = getPollFn(sdk, res, ref);\n        break;\n\n      default:\n        var fn = link2fn(sdk, res, obj, link, ref);\n        if (fn) {\n          fns[linkName] = fn;\n        }\n    }\n  }\n  return fns;\n}\n\n// eslint-disable-next-line complexity\nfunction flattenEmbedded(sdk, res, obj, ref) {\n  obj = obj || res;\n  obj = clone(obj);\n\n  if (Array.isArray(obj)) {\n    var objArr = [];\n    for (var o = 0, ol = obj.length; o < ol; o++) {\n      objArr.push(flattenEmbedded(sdk, res, obj[o], ref) as never);\n    }\n    return objArr;\n  }\n\n  var embedded = obj._embedded || {};\n\n  for (var key in embedded) {\n    if (!Object.prototype.hasOwnProperty.call(embedded, key)) {\n      continue;\n    }\n\n    // Flatten any nested _embedded objects\n    if (isObject(embedded[key]) || Array.isArray(embedded[key])) {\n      embedded[key] = flattenEmbedded(sdk, res, embedded[key], ref);\n    }\n  }\n\n  // Convert any links on the embedded object\n  var fns = links2fns(sdk, res, obj, ref);\n  Object.assign(embedded, fns);\n\n  obj = omit(obj, '_embedded', '_links');\n  Object.assign(obj, embedded);\n  return obj;\n}\n"]},"metadata":{},"sourceType":"module"}